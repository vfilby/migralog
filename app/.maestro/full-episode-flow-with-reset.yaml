appId: com.eff3.app.headache-tracker
---
# Full Episode Flow Test - With UI Database Reset
# Tests creating an episode from a clean state using the Settings UI to reset

# Launch app
- launchApp

# Wait for app to fully load
- assertVisible: "Pain Tracker"

# Navigate to Settings
- tapOn:
    id: "settings-button"

# Wait for Settings screen to load
- assertVisible: "Settings"

# Scroll down to Developer section
- scrollUntilVisible:
    element:
      id: "reset-database-button"
    direction: DOWN
    speed: 80

# Tap Reset Database button
- tapOn:
    id: "reset-database-button"

# Confirm the reset in the alert
- tapOn: "Reset"

# Wait for reset to complete and alert to dismiss
- tapOn: "OK"

# Go back to dashboard
- tapOn: "Done"

# Verify we're back on dashboard
- assertVisible: "Pain Tracker"
- assertVisible:
    id: "dashboard-title"

# Verify Start Episode button is visible (only shows when no active episode)
- assertVisible:
    id: "start-episode-button"

# Start a new episode
- tapOn:
    id: "start-episode-button"

# Should be on Start Episode screen
- assertVisible: "Start Episode"

# Scroll down to make sure save button is visible
- scrollUntilVisible:
    element:
      id: "save-episode-button"
    direction: DOWN
    speed: 80

# Tap the save button (which says "Start Episode")
# This creates an episode with default intensity (3)
- tapOn:
    id: "save-episode-button"

# Give it a moment to save and navigate
- waitForAnimationToEnd

# Wait for navigation back to dashboard
- assertVisible: "Pain Tracker"

# Verify we're on the dashboard
- assertVisible:
    id: "dashboard-title"

# Verify episode was created - Start Episode button should NOT be visible anymore
# (it only shows when there's no active episode)
- assertNotVisible:
    id: "start-episode-button"

# Test passed - episode created successfully from clean state!
