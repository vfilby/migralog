{"id":"MigraineTracker-046b","content_hash":"37b8476f3880b8729a539905246ca2981c8aeec26d638211fea6c60be8b914d3","title":"Push branch to remote repository","description":"Push the feature branch to the remote repository after all tests pass.\n\n**Prerequisites:**\n- All implementation tasks completed\n- All tests passing (npm run precommit succeeded)\n\n**Command:** git push origin feature/end-ongoing-episode\n\n**Success criteria:**\n- Branch successfully pushed to remote\n- No git errors or conflicts\n- Branch visible on GitHub: https://github.com/vfilby/migralog/tree/feature/end-ongoing-episode\n\n**If push fails:**\n- Check for upstream changes: git fetch origin main\n- Resolve any conflicts if necessary\n- Re-run precommit tests if code was modified\n- Retry push\n\n**Note:** This must succeed before creating the pull request.","status":"open","priority":1,"issue_type":"task","created_at":"2025-11-02T12:01:39.341084-08:00","updated_at":"2025-11-02T12:01:39.341084-08:00","dependencies":[{"issue_id":"MigraineTracker-046b","depends_on_id":"MigraineTracker-9ca7","type":"blocks","created_at":"2025-11-02T12:03:44.057376-08:00","created_by":"vfilby"}]}
{"id":"MigraineTracker-1","content_hash":"faa5982f5bc29621b2d1cf9c80186b7c3c1f0218ddfc55370b49fce339d63ee5","title":"Fix medication notifications triggering after early dose","description":"Notifications should not fire if medication was already logged before the scheduled time. GitHub issue #49","status":"closed","priority":1,"issue_type":"bug","created_at":"2025-10-20T21:58:17.322506-07:00","updated_at":"2025-10-20T22:02:27.529447-07:00","closed_at":"2025-10-20T22:02:27.529447-07:00"}
{"id":"MigraineTracker-10","content_hash":"202455134f3792f107810e2f9f933bdfcf048c42a5100a34bf9065a6d6b6c034","title":"Update CLAUDE.md documentation","description":"Update project documentation to reflect ULID usage.\n\nFile: CLAUDE.md\n\nChanges needed:\n1. Document ID generation approach\n2. Add ULID to tech stack\n3. Document testing patterns for ULID mocks\n4. Add migration notes (for future reference)\n\nExample addition:\n```markdown\n## ID Generation\n\nThe app uses ULID (Universally Unique Lexicographically Sortable Identifier) for all database IDs.\n\n**Library:** `ulidx` with `react-native-get-random-values` polyfill\n\n**Format:** 26-character Base32 string (e.g., `01ARZ3NDEKTSV4RRFFQ69G5FAV`)\n\n**Benefits:**\n- 128-bit with 80 bits cryptographic randomness\n- Lexicographically sortable (timestamp-based)\n- Compact and URL-safe\n- Cloud sync ready\n\n**Testing:** Use mock utilities in testHelpers.ts for deterministic tests\n```","acceptance_criteria":"- CLAUDE.md includes ULID documentation\n- Tech stack section updated\n- Testing guidance added\n- Migration notes documented","status":"closed","priority":3,"issue_type":"task","created_at":"2025-10-21T07:19:06.293055-07:00","updated_at":"2025-10-21T07:47:55.199774-07:00","closed_at":"2025-10-21T07:47:55.199774-07:00","dependencies":[{"issue_id":"MigraineTracker-10","depends_on_id":"MigraineTracker-12","type":"blocks","created_at":"2025-10-21T07:19:39.742785-07:00","created_by":"daemon"},{"issue_id":"MigraineTracker-10","depends_on_id":"MigraineTracker-2","type":"parent-child","created_at":"2025-10-21T07:20:22.205073-07:00","created_by":"daemon"}]}
{"id":"MigraineTracker-11","content_hash":"2206851deee531b94f8c62f78fb14e9e443f979b3d9f12871f4e1e82fe087d70","title":"Run precommit checks and verify build","description":"Execute all precommit checks to ensure the ULID migration is production-ready.\n\nCommands:\n```bash\ncd app\nnpm run precommit\n```\n\nThis runs:\n- ESLint with zero warnings\n- TypeScript type checking\n- Full test suite with coverage\n\nAdditional manual checks:\n1. Test iOS build: `npm run ios`\n2. Test Android build: `npm run android`\n3. Verify app launches without errors\n4. Create a few test records to verify ULID generation\n5. Check ULID format in database (should be 26 chars)\n\nLook for:\n- No TypeScript errors\n- No lint warnings\n- All tests pass\n- App builds successfully\n- IDs are proper ULID format","acceptance_criteria":"- npm run precommit passes with 0 errors/warnings\n- iOS build succeeds\n- Android build succeeds\n- App launches and generates valid ULIDs\n- Manual testing shows IDs are 26-character ULIDs","status":"closed","priority":2,"issue_type":"task","created_at":"2025-10-21T07:19:20.683313-07:00","updated_at":"2025-10-21T07:48:15.740803-07:00","closed_at":"2025-10-21T07:48:15.740803-07:00","dependencies":[{"issue_id":"MigraineTracker-11","depends_on_id":"MigraineTracker-12","type":"blocks","created_at":"2025-10-21T07:19:44.336735-07:00","created_by":"daemon"},{"issue_id":"MigraineTracker-11","depends_on_id":"MigraineTracker-2","type":"parent-child","created_at":"2025-10-21T07:20:22.21414-07:00","created_by":"daemon"}]}
{"id":"MigraineTracker-12","content_hash":"0586071042ac14fbc89773b8585dc0d8e7c64d9bdd8bb4c83bafbb2bb6f8a20f","title":"Create PR and close GitHub issue #18","description":"Create pull request for ULID migration and link to GitHub issue.\n\nPR Title: \"feat: Migrate to ULID for all database IDs\"\n\nPR Description should include:\n- Summary of changes\n- Why ULID was chosen (security, cloud-sync ready, sortable)\n- Libraries added (ulidx, react-native-get-random-values)\n- Test coverage status\n- Migration impact (none - pre-production)\n- Link to issue #18\n\nChecklist:\n- [ ] Create feature branch: `feature/ulid-migration`\n- [ ] Commit all changes\n- [ ] Push to remote\n- [ ] Create PR via gh pr create\n- [ ] Reference \"Fixes #18\" in PR description\n- [ ] Verify CI checks pass\n- [ ] Request review if needed\n\nAfter merge:\n- Close Beads epic MigraineTracker-2\n- Verify GitHub issue #18 auto-closed","acceptance_criteria":"- PR created and linked to issue #18\n- All CI checks pass\n- PR description is comprehensive\n- GitHub issue #18 closes when PR merges","notes":"IMPORTANT: Do not create PR until all implementation, testing, documentation, and verification tasks are 100% complete. This is the final step after everything else is done and working.","status":"closed","priority":3,"issue_type":"task","created_at":"2025-10-21T07:19:34.593075-07:00","updated_at":"2025-10-21T08:03:29.865498-07:00","closed_at":"2025-10-21T08:03:29.865498-07:00","dependencies":[{"issue_id":"MigraineTracker-12","depends_on_id":"MigraineTracker-2","type":"parent-child","created_at":"2025-10-21T07:20:22.222913-07:00","created_by":"daemon"}]}
{"id":"MigraineTracker-13","content_hash":"4f31bf4d99c63e1290f1258f1924462eeae21e1d60e859e1af5a61bed25f6fc5","title":"POST-PR: Add data migration strategy for existing user","description":"Add safety checks to ensure ULID migration doesn't break existing installations.\n\n**Context:**\n- Current schema version: 8\n- ID columns: All TEXT type (no schema change needed)\n- Old format: timestamp-random (~25-30 chars)\n- New format: ULID (26 chars)\n- Pre-production: No known production users\n\n**Implementation:**\n\n1. Add version check in migrations.ts:\n```typescript\n// migration version 9: ULID transition (no-op migration)\n{\n  version: 9,\n  name: 'ulid_transition_marker',\n  up: async (db: SQLite.SQLiteDatabase) =\u003e {\n    // This is a marker migration - no actual changes needed\n    // All ID columns are already TEXT and compatible with ULID\n    logger.log('[Migration 9] ULID transition: no schema changes required');\n    \n    // Optional: Log existing data count for safety\n    const tables = ['episodes', 'medications', 'medication_doses', 'daily_status_logs'];\n    for (const table of tables) {\n      const result = await db.getAllAsync(`SELECT COUNT(*) as count FROM ${table}`);\n      logger.log(`[Migration 9] ${table}: ${result[0].count} existing records`);\n    }\n  },\n}\n```\n\n2. Add SCHEMA_VERSION bump to 9 in schema.ts\n\n3. Add safety documentation in migration comments\n\n**Acceptance Criteria:**\n- Schema version bumped to 9\n- Migration 9 added (no-op marker)\n- Existing installations log data counts\n- New installations skip straight to v9\n- Documentation explains why no data migration needed","acceptance_criteria":"- SCHEMA_VERSION = 9 in schema.ts\n- Migration 9 added to migrations.ts\n- Migration logs existing data counts\n- Migration is a no-op (no ALTER TABLE)\n- Comments explain ULID compatibility","status":"closed","priority":1,"issue_type":"task","created_at":"2025-10-21T07:24:34.506869-07:00","updated_at":"2025-11-02T11:52:45.764357-08:00","closed_at":"2025-11-02T11:52:45.764357-08:00"}
{"id":"MigraineTracker-14","content_hash":"78750c0145fefa4bf41b2a9760b2c7352f3b153be07d7b0cd3faa89344daa617","title":"Improve sparkline gradient background styling","description":"The transparent gradient background in IntensitySparkline provides useful scale context, but the current style could be improved. Currently uses 15% opacity gradient with pain scale colors (greenâ†’purple).\n\nCurrent implementation in IntensitySparkline.tsx:\n- LinearGradient with 11 color stops from PAIN_SCALE\n- stopOpacity=\"0.15\" for subtlety\n- Renders as background behind the sparkline path\n\nNeed to explore alternative visual approaches that maintain the scale indication while improving aesthetics.","design":"Potential approaches to consider:\n\n1. **Adjust opacity**: Try different opacity levels (10%, 20%, 25%) to find better balance\n2. **Different gradient style**: \n   - Use fewer color stops (just key pain levels: mild, moderate, severe)\n   - Add gradient blur/feathering for smoother transitions\n   - Try radial gradient instead of linear\n3. **Alternative visual indicators**:\n   - Subtle horizontal bands/zones instead of gradient\n   - Faded grid lines at pain level thresholds\n   - Subtle texture or pattern overlay\n4. **Color adjustments**:\n   - Desaturate the gradient colors\n   - Use single-color gradient with varying intensity\n   - Match theme colors more closely\n\nFile to modify: src/components/IntensitySparkline.tsx (lines 106-129)","notes":"Assigned to agent: demo-agent-1","status":"closed","priority":2,"issue_type":"task","created_at":"2025-10-23T22:01:42.473972-07:00","updated_at":"2025-11-02T11:52:47.769578-08:00","closed_at":"2025-11-02T11:52:47.769578-08:00"}
{"id":"MigraineTracker-15","content_hash":"40eff057bcc2eb8c457040b9f914af5ea72205c47d984fcd72be5418b7cc7061","title":"Remove superfluous follow-up notification after medication is logged","description":"Currently when a medication is logged from a notification action, a follow-up notification is sent confirming it has been logged. This is unnecessary and should be removed.","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-10-24T07:56:40.973724-07:00","updated_at":"2025-10-24T08:46:20.87447-07:00","closed_at":"2025-10-24T08:46:20.87447-07:00"}
{"id":"MigraineTracker-16","content_hash":"8f04dbcc6d0516c1e5d32214f9a7d28b5017f9de7dfe7b53177b3615c41d427c","title":"Enable time-sensitive notifications for medication reminders","description":"Medication reminders should use time-sensitive notification priority so they still display even when the user is in a focus mode. This ensures critical medication reminders are not missed.","status":"closed","priority":1,"issue_type":"feature","created_at":"2025-10-24T07:56:46.840032-07:00","updated_at":"2025-10-24T10:39:33.589105-07:00","closed_at":"2025-10-24T10:39:33.589105-07:00"}
{"id":"MigraineTracker-17","content_hash":"7e327635ab414c2c59d49edc7656488a7144783c56f3fdd76f972fe805484694","title":"Fix dashboard not updating after logging medication from notification","description":"After logging a medication from a notification action, the dashboard doesn't show the medication as logged until something triggers a re-render (like navigating to a sub page and back). The dashboard should immediately reflect the updated state.","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-10-24T07:56:53.632702-07:00","updated_at":"2025-10-24T10:34:46.135853-07:00","closed_at":"2025-10-24T10:34:46.135853-07:00"}
{"id":"MigraineTracker-18","content_hash":"3c30c17a433b8a5f45260320df17bb9bb026490a5dc68366f369891b009b3c47","title":"Add configurable follow-up reminder with critical alert sound","description":"Add an optional 30-minute follow-up reminder if the user hasn't taken action (neither dismissed nor logged as taken). This reminder should use critical alert sound that plays even when the phone is silenced.","design":"Requires iOS critical alerts entitlement. Will need to request special permission from Apple. The follow-up reminder should be configurable per medication or globally.","status":"closed","priority":1,"issue_type":"feature","created_at":"2025-10-24T07:57:00.47355-07:00","updated_at":"2025-10-24T11:03:41.42228-07:00","closed_at":"2025-10-24T11:03:41.42228-07:00"}
{"id":"MigraineTracker-19","content_hash":"3bdbabecc4566d766241ae1e6fc36e69ba3d2956e2550fdb295d3403111a0869","title":"Add notification settings UI in Settings and medication screens","description":"Create UI to allow users to configure notification preferences including:\n- Time-sensitive notifications (on/off)\n- Follow-up reminder delay (off, 15 min, 30 min, 45 min, 60 min)\n- Critical alert sound for follow-ups (on/off)\n- Confirmation notifications (on/off)\n\nSettings should be accessible from both the Settings screen (global defaults) and individual medication detail screens (per-medication overrides).","status":"closed","priority":1,"issue_type":"feature","created_at":"2025-10-24T07:57:08.916029-07:00","updated_at":"2025-10-24T13:53:57.62547-07:00","closed_at":"2025-10-24T13:53:57.62547-07:00","dependencies":[{"issue_id":"MigraineTracker-19","depends_on_id":"MigraineTracker-15","type":"blocks","created_at":"2025-10-24T07:57:15.70552-07:00","created_by":"daemon"},{"issue_id":"MigraineTracker-19","depends_on_id":"MigraineTracker-16","type":"blocks","created_at":"2025-10-24T07:57:20.706497-07:00","created_by":"daemon"},{"issue_id":"MigraineTracker-19","depends_on_id":"MigraineTracker-18","type":"blocks","created_at":"2025-10-24T07:57:26.939786-07:00","created_by":"daemon"}]}
{"id":"MigraineTracker-2","content_hash":"fc0c9fdaac291ad7f97beab191aeba779ac3222470d4294a418b34f64da67a1c","title":"Migrate from timestamp-based IDs to ULID","description":"Replace the current home-grown ID generation (Date.now() + Math.random()) with ULID (Universally Unique Lexicographically Sortable Identifier) to support future cloud sync, improve security, and use industry-standard identifiers.\n\nContext:\n- Current: `${Date.now()}-${Math.random().toString(36).substr(2, 9)}`\n- Target: ULID (128-bit, 26-character Base32 string)\n- Benefits: Cryptographically secure, sortable, cloud-sync ready, compact\n- Library: ulidx + react-native-get-random-values polyfill\n\nScope:\n- 10 database tables with ID columns\n- ~9 calls to generateId() across repositories\n- All tests need updating for deterministic ULID mocks\n- Migration strategy (none needed - pre-production)","status":"closed","priority":2,"issue_type":"epic","created_at":"2025-10-21T07:17:02.193282-07:00","updated_at":"2025-10-21T08:03:29.874864-07:00","closed_at":"2025-10-21T08:03:29.874864-07:00"}
{"id":"MigraineTracker-20","content_hash":"c5f5887b2b1924d9bd69d4181ee5092fa20fcbcb7c2236b42d2a75d3faa13e78","title":"Improve ongoing episode card styling on dashboard","description":"The ongoing episode card on the dashboard needs better visual treatment to indicate it requires attention:\n1. Use compact styling (similar to recent episodes cards)\n2. Add visual cue that it's a problem (amber or red outline)\n3. Add the \"Ongoing\" badge that appears on the episode detail page\n4. Current state: Takes up too much space and doesn't clearly indicate it needs attention\n5. Reference: Episode detail page has good \"Ongoing\" badge example","notes":"Assigned to agent: demo-agent-2","status":"closed","priority":2,"issue_type":"task","created_at":"2025-10-27T22:02:21.628931-07:00","updated_at":"2025-11-02T11:52:49.789481-08:00","closed_at":"2025-11-02T11:52:49.789481-08:00"}
{"id":"MigraineTracker-3","content_hash":"8ff7c7e3d9ad75cae1ff46bc94714d498edd5bf4c8e716413c6b449205b80857","title":"Install ULID dependencies","description":"Install ulidx and react-native-get-random-values packages.\n\nCommands:\n```bash\ncd app\nnpm install ulidx react-native-get-random-values --save\n```\n\nVerification:\n- Check package.json includes both dependencies\n- Run npm install to ensure no conflicts\n- Verify no peer dependency warnings","acceptance_criteria":"- ulidx added to package.json dependencies\n- react-native-get-random-values added to package.json dependencies\n- npm install completes without errors\n- No peer dependency conflicts","status":"closed","priority":1,"issue_type":"task","created_at":"2025-10-21T07:17:08.952874-07:00","updated_at":"2025-10-21T07:33:30.801368-07:00","closed_at":"2025-10-21T07:33:30.801368-07:00","dependencies":[{"issue_id":"MigraineTracker-3","depends_on_id":"MigraineTracker-4","type":"blocks","created_at":"2025-10-21T07:17:29.452481-07:00","created_by":"daemon"},{"issue_id":"MigraineTracker-3","depends_on_id":"MigraineTracker-5","type":"blocks","created_at":"2025-10-21T07:17:41.969254-07:00","created_by":"daemon"},{"issue_id":"MigraineTracker-3","depends_on_id":"MigraineTracker-6","type":"blocks","created_at":"2025-10-21T07:17:58.3428-07:00","created_by":"daemon"},{"issue_id":"MigraineTracker-3","depends_on_id":"MigraineTracker-2","type":"parent-child","created_at":"2025-10-21T07:19:55.102271-07:00","created_by":"daemon"}]}
{"id":"MigraineTracker-3d3a","content_hash":"acaca8384428ecfbb94a5a1e4de6e5250177a367dca5db8c2f37646a63ad7ed6","title":"[FEEDBACK] Agent agent-test: This is a test feedback request - should I proceed with the approach?","description":"Agent agent-test needs user feedback while working on issue MigraineTracker-13.\n\n**Context:**\n- Agent: agent-test\n- Working on: MigraineTracker-13 - POST-PR: Add data migration strategy for existing user\n- Branch: agent/agent-test/MigraineTracker-13\n\n**Question:**\nThis is a test feedback request - should I proceed with the approach?\n\n**Instructions:**\n1. Review the agent's question\n2. Provide guidance or decision\n3. Update this issue with your response\n4. Close this issue when feedback is provided\n\n**Agent will be notified when this issue is closed.**","status":"closed","priority":0,"issue_type":"task","created_at":"2025-11-01T13:07:17.782165-07:00","updated_at":"2025-11-02T11:52:37.26755-08:00","closed_at":"2025-11-02T11:52:37.26755-08:00","dependencies":[{"issue_id":"MigraineTracker-3d3a","depends_on_id":"MigraineTracker-13","type":"discovered-from","created_at":"2025-11-01T13:07:17.782774-07:00","created_by":"vfilby"}]}
{"id":"MigraineTracker-4","content_hash":"934713c869a3e3eecfe2e8ed95dba8ffee44969ba2541a1009f11656b4ee3d96","title":"Update generateId() implementation in db.ts","description":"Replace the current timestamp-based ID generation with ULID.\n\nLocation: app/src/database/db.ts\n\nCurrent implementation:\n```typescript\nexport const generateId = (): string =\u003e {\n  return `${Date.now()}-${Math.random().toString(36).substr(2, 9)}`;\n};\n```\n\nNew implementation:\n```typescript\nimport 'react-native-get-random-values';\nimport { ulid } from 'ulidx';\n\nexport const generateId = (): string =\u003e {\n  return ulid();\n};\n```\n\nNotes:\n- Import polyfill BEFORE ulidx import\n- Remove old implementation completely\n- Keep function signature identical (no breaking changes)","acceptance_criteria":"- react-native-get-random-values imported at top of db.ts\n- ulidx imported after polyfill\n- generateId() returns ulid() \n- Function signature unchanged\n- No TypeScript errors","status":"closed","priority":1,"issue_type":"task","created_at":"2025-10-21T07:17:16.617065-07:00","updated_at":"2025-10-21T07:43:10.235259-07:00","closed_at":"2025-10-21T07:43:10.235259-07:00","dependencies":[{"issue_id":"MigraineTracker-4","depends_on_id":"MigraineTracker-7","type":"blocks","created_at":"2025-10-21T07:18:16.319853-07:00","created_by":"daemon"},{"issue_id":"MigraineTracker-4","depends_on_id":"MigraineTracker-8","type":"blocks","created_at":"2025-10-21T07:18:34.160034-07:00","created_by":"daemon"},{"issue_id":"MigraineTracker-4","depends_on_id":"MigraineTracker-2","type":"parent-child","created_at":"2025-10-21T07:20:22.149581-07:00","created_by":"daemon"}]}
{"id":"MigraineTracker-5","content_hash":"75f2ca8c7e39b13804f95db219a17148f7ce4f5d9a09fa13472b34daaa96efef","title":"Update db.web.ts with ULID implementation","description":"Update the web platform-specific database file with ULID.\n\nLocation: app/src/database/db.web.ts\n\nThe web version should use the same ULID implementation for consistency across platforms.\n\nImplementation:\n```typescript\nimport 'react-native-get-random-values';\nimport { ulid } from 'ulidx';\n\nexport const generateId = (): string =\u003e {\n  return ulid();\n};\n```\n\nNotes:\n- Web platform uses browser's crypto.getRandomValues\n- Polyfill should work in browser context\n- Keep implementation identical to db.ts","acceptance_criteria":"- react-native-get-random-values imported\n- ulidx imported\n- generateId() returns ulid()\n- Web build compiles without errors","status":"closed","priority":1,"issue_type":"task","created_at":"2025-10-21T07:17:37.18255-07:00","updated_at":"2025-10-21T07:43:39.949423-07:00","closed_at":"2025-10-21T07:43:39.949423-07:00","dependencies":[{"issue_id":"MigraineTracker-5","depends_on_id":"MigraineTracker-2","type":"parent-child","created_at":"2025-10-21T07:20:22.161574-07:00","created_by":"daemon"}]}
{"id":"MigraineTracker-5236","content_hash":"df05faca1345eba52ddf2e5b31084ca22485b25d70cac1680a8e3b0047cc79ce","title":"Add test coverage for end episode functionality","description":"Create comprehensive tests for the new end episode feature.\n\n**Test files to create/update:**\n- app/src/screens/__tests__/EpisodeDetailScreen.test.tsx\n- app/src/store/__tests__/episodeStore.test.ts\n\n**Test cases:**\n- 'End Episode' button appears for ongoing episodes\n- 'End Episode' button hidden for completed episodes\n- Date/time picker opens when button pressed\n- Episode end_time is saved correctly\n- UI updates to show episode as completed\n- Store action handles errors gracefully\n\n**Coverage requirements:**\n- Follow existing test patterns in the codebase\n- Use @testing-library/react-native for component tests\n- Ensure all edge cases are covered\n- Tests must pass in both host and container environments","status":"open","priority":1,"issue_type":"task","created_at":"2025-11-02T11:58:42.215102-08:00","updated_at":"2025-11-02T11:58:42.215102-08:00"}
{"id":"MigraineTracker-5529","content_hash":"775e2c68a9b0b11050bcd8455fa4d73b6c3783b7e2c96c440573d296b578a908","title":"Add ability to end ongoing episodes","description":"Implement UI to allow users to set end time for ongoing episodes. Currently there's no way to end an ongoing episode from the edit screen.\n\n**GitHub Issue:** #39\n\n**Approach:**\nAdd \"End Episode\" button to EpisodeDetailScreen that:\n- Appears only for ongoing episodes (end_time is null)\n- Opens date/time picker defaulting to current time\n- Allows user to adjust end time before confirming\n- Saves end_time and transitions episode to completed status\n\n**Files to modify:**\n- app/src/screens/EpisodeDetailScreen.tsx - Add UI for ending episode\n- app/src/store/episodeStore.ts - Add endEpisode action\n- app/src/database/episodeRepository.ts - Verify updateEpisode handles end_time\n\n**Reference implementation:**\n- See how date/time pickers are used in NewEpisodeScreen\n- Follow theme system patterns (light/dark mode support)\n- Use existing UI components and styling patterns","acceptance_criteria":"- \"End Episode\" button appears only for ongoing episodes\n- Date/time picker defaults to current time but is adjustable\n- Episode end_time is set and persisted to database\n- Episode status changes from ongoing to completed\n- UI updates immediately to reflect completed status\n- Supports both light and dark mode\n- All existing tests pass (npm run precommit)\n- New functionality has test coverage\n- Branch pushed to remote: git push origin feature/end-ongoing-episode\n- PR created: gh pr create --base main --title 'feat: add ability to end ongoing episodes' --body 'Closes #39'","status":"open","priority":1,"issue_type":"feature","created_at":"2025-11-02T11:56:56.822427-08:00","updated_at":"2025-11-02T11:56:56.822427-08:00","external_ref":"gh-39","dependencies":[{"issue_id":"MigraineTracker-5529","depends_on_id":"MigraineTracker-939e","type":"parent-child","created_at":"2025-11-02T11:57:45.845394-08:00","created_by":"vfilby"},{"issue_id":"MigraineTracker-5529","depends_on_id":"MigraineTracker-cfd2","type":"parent-child","created_at":"2025-11-02T11:58:30.889483-08:00","created_by":"vfilby"},{"issue_id":"MigraineTracker-5529","depends_on_id":"MigraineTracker-97f2","type":"parent-child","created_at":"2025-11-02T11:58:42.198669-08:00","created_by":"vfilby"},{"issue_id":"MigraineTracker-5529","depends_on_id":"MigraineTracker-5236","type":"parent-child","created_at":"2025-11-02T11:58:56.159668-08:00","created_by":"vfilby"},{"issue_id":"MigraineTracker-5529","depends_on_id":"MigraineTracker-8476","type":"parent-child","created_at":"2025-11-02T11:59:10.376203-08:00","created_by":"vfilby"},{"issue_id":"MigraineTracker-5529","depends_on_id":"MigraineTracker-9ca7","type":"parent-child","created_at":"2025-11-02T12:01:48.668583-08:00","created_by":"vfilby"},{"issue_id":"MigraineTracker-5529","depends_on_id":"MigraineTracker-046b","type":"parent-child","created_at":"2025-11-02T12:01:48.681315-08:00","created_by":"vfilby"}]}
{"id":"MigraineTracker-6","content_hash":"f017a6db2d49c7b4a577a847ae7e2bc05c9bd2766479a2ac0d893aff3f049292","title":"Create ULID test utilities and mocks","description":"Create test utilities for mocking ULID generation to ensure deterministic tests.\n\nCreate new file: app/src/utils/testHelpers.ts (or update existing)\n\nImplementation:\n```typescript\nimport { ulid } from 'ulidx';\n\n// Mock ULID for deterministic tests\nexport const mockUlid = (seed: number = 0): string =\u003e {\n  // Return predictable ULIDs for testing\n  const timestamp = 1609459200000 + seed; // Fixed timestamp\n  const randomPart = seed.toString(36).padStart(16, '0');\n  return `01E${timestamp.toString(36).toUpperCase()}${randomPart.toUpperCase()}`;\n};\n\n// Jest mock setup helper\nexport const setupUlidMocks = () =\u003e {\n  let counter = 0;\n  jest.mock('ulidx', () =\u003e ({\n    ulid: jest.fn(() =\u003e mockUlid(counter++)),\n  }));\n};\n```\n\nNotes:\n- ULIDs must be 26 characters\n- Must be lexicographically sortable in tests\n- Consider using ulidx's decodeTime for test assertions","acceptance_criteria":"- Test helper functions created\n- Mock ULID generator produces valid 26-char strings\n- Mocked ULIDs are sortable and predictable\n- Helper functions documented","status":"closed","priority":1,"issue_type":"task","created_at":"2025-10-21T07:17:52.729203-07:00","updated_at":"2025-10-21T07:44:26.500687-07:00","closed_at":"2025-10-21T07:44:26.500687-07:00","dependencies":[{"issue_id":"MigraineTracker-6","depends_on_id":"MigraineTracker-7","type":"blocks","created_at":"2025-10-21T07:18:20.075793-07:00","created_by":"daemon"},{"issue_id":"MigraineTracker-6","depends_on_id":"MigraineTracker-8","type":"blocks","created_at":"2025-10-21T07:18:39.12929-07:00","created_by":"daemon"},{"issue_id":"MigraineTracker-6","depends_on_id":"MigraineTracker-2","type":"parent-child","created_at":"2025-10-21T07:20:22.170816-07:00","created_by":"daemon"}]}
{"id":"MigraineTracker-7","content_hash":"b00bbbad0bf0048e910acaf1eea215a13ab32882176ce97fd44539336a3be4ba","title":"Update repository tests to use ULID mocks","description":"Update all repository test files to mock ULID generation for deterministic tests.\n\nFiles to update:\n- app/src/database/__tests__/episodeRepository.test.ts\n- app/src/database/__tests__/medicationRepository.test.ts\n- app/src/database/__tests__/dailyStatusRepository.test.ts\n\nChanges needed:\n1. Import ULID mock utilities\n2. Mock generateId() to return predictable ULIDs\n3. Update test expectations to use ULID format\n4. Update any ID assertions (format changed from timestamp-random to ULID)\n\nExample pattern:\n```typescript\nimport { generateId } from '../db';\n\njest.mock('../db', () =\u003e ({\n  ...jest.requireActual('../db'),\n  generateId: jest.fn(() =\u003e 'TEST_ULID_0000000000'),\n}));\n\nbeforeEach(() =\u003e {\n  (generateId as jest.Mock).mockReturnValue('TEST_ULID_0000000000');\n});\n```","acceptance_criteria":"- All repository test files updated\n- generateId() properly mocked in each test\n- All tests pass with ULID format\n- No hardcoded timestamp-based IDs in tests","status":"closed","priority":2,"issue_type":"task","created_at":"2025-10-21T07:18:12.019801-07:00","updated_at":"2025-10-21T07:46:56.858198-07:00","closed_at":"2025-10-21T07:46:56.858198-07:00","dependencies":[{"issue_id":"MigraineTracker-7","depends_on_id":"MigraineTracker-9","type":"blocks","created_at":"2025-10-21T07:18:50.951794-07:00","created_by":"daemon"},{"issue_id":"MigraineTracker-7","depends_on_id":"MigraineTracker-2","type":"parent-child","created_at":"2025-10-21T07:20:22.179353-07:00","created_by":"daemon"}]}
{"id":"MigraineTracker-72ee","content_hash":"b997f3ef12adf0028d77e75c9126e963bfb31a903747393cf70f1c8eb2182edd","title":"[FEEDBACK] Agent demo-agent-1: I found multiple CSS approaches for the sparkline gradient. Should I use linear-gradient, radial-gradient, or CSS-in-JS styled-components?","description":"Agent demo-agent-1 needs user feedback while working on issue MigraineTracker-14.\n\n**Context:**\n- Agent: demo-agent-1\n- Working on: MigraineTracker-14 - Improve sparkline gradient background styling\n- Branch: agent/demo-agent-1/MigraineTracker-14\n\n**Question:**\nI found multiple CSS approaches for the sparkline gradient. Should I use linear-gradient, radial-gradient, or CSS-in-JS styled-components?\n\n**Instructions:**\n1. Review the agent's question\n2. Provide guidance or decision\n3. Update this issue with your response\n4. Close this issue when feedback is provided\n\n**Agent will be notified when this issue is closed.**","status":"closed","priority":0,"issue_type":"task","created_at":"2025-11-01T13:35:26.100986-07:00","updated_at":"2025-11-02T11:52:43.276077-08:00","closed_at":"2025-11-02T11:52:43.276077-08:00","dependencies":[{"issue_id":"MigraineTracker-72ee","depends_on_id":"MigraineTracker-14","type":"discovered-from","created_at":"2025-11-01T13:35:26.101758-07:00","created_by":"vfilby"}]}
{"id":"MigraineTracker-8","content_hash":"2c3da8bdee28dcf33a87cc99b5fee834885c618a14179efedfcf2fea15612617","title":"Update service/store tests to use ULID mocks","description":"Update all service and store test files to handle ULID format.\n\nFiles to update:\n- app/src/services/__tests__/notificationService.test.ts\n- app/src/services/__tests__/backupService.test.ts\n- app/src/store/__tests__/*.test.ts (if any use generateId)\n\nChanges needed:\n1. Update mocks to return ULID format\n2. Update any ID format validations\n3. Update snapshot tests if they capture IDs\n4. Ensure no tests break due to ID format change\n\nNote: Most service tests likely don't generate IDs directly, but may assert on ID format in responses.","acceptance_criteria":"- All service test files reviewed and updated\n- All store test files reviewed and updated\n- Mocks return valid ULID format\n- All tests pass","status":"closed","priority":2,"issue_type":"task","created_at":"2025-10-21T07:18:29.618146-07:00","updated_at":"2025-10-21T07:47:28.865256-07:00","closed_at":"2025-10-21T07:47:28.865256-07:00","dependencies":[{"issue_id":"MigraineTracker-8","depends_on_id":"MigraineTracker-9","type":"blocks","created_at":"2025-10-21T07:18:55.166379-07:00","created_by":"daemon"},{"issue_id":"MigraineTracker-8","depends_on_id":"MigraineTracker-2","type":"parent-child","created_at":"2025-10-21T07:20:22.187728-07:00","created_by":"daemon"}]}
{"id":"MigraineTracker-8476","content_hash":"2feb709b64f77ec53d2ee1794c3a88a423c2f26f896aa5bdd4524444b5d60629","title":"Create pull request","description":"Create pull request after all implementation and verification is complete.\n\n**Prerequisites:**\n- All subtasks completed\n- All tests passing (verified in previous task)\n- Branch pushed to remote (verified in previous task)\n\n**Steps:**\n1. Create PR: gh pr create --base main --title 'feat: add ability to end ongoing episodes' --body 'Closes #39'\n2. Verify PR created successfully\n3. Check that CI/CD pipeline runs\n4. Verify PR is linked to GitHub issue #39\n\n**Success criteria:**\n- PR created and visible on GitHub\n- PR linked to issue #39\n- CI checks start running\n- PR is ready for review","status":"open","priority":1,"issue_type":"task","created_at":"2025-11-02T11:58:56.174611-08:00","updated_at":"2025-11-02T12:01:04.537669-08:00","dependencies":[{"issue_id":"MigraineTracker-8476","depends_on_id":"MigraineTracker-046b","type":"blocks","created_at":"2025-11-02T12:03:44.068842-08:00","created_by":"vfilby"}]}
{"id":"MigraineTracker-9","content_hash":"e44f4d78abaa6320ff0e58334b19f077f4f35100d8ae652f300dee391a983257","title":"Run full test suite and fix any failures","description":"Execute complete test suite to identify and fix any ULID-related failures.\n\nCommands:\n```bash\ncd app\nnpm test\n```\n\nExpected issues to fix:\n- Tests expecting old ID format (timestamp-random)\n- Hardcoded ID expectations in assertions\n- Snapshot tests with embedded IDs\n- Mock setup issues\n- ID validation regex/patterns\n\nProcess:\n1. Run full test suite\n2. Document all failures\n3. Fix each failure systematically\n4. Re-run tests until all pass\n5. Document any non-obvious fixes in test comments","acceptance_criteria":"- npm test passes with 0 failures\n- All 778+ tests pass\n- No skipped tests related to ULID\n- Coverage maintained or improved","status":"closed","priority":2,"issue_type":"task","created_at":"2025-10-21T07:18:47.417664-07:00","updated_at":"2025-10-21T07:47:34.416939-07:00","closed_at":"2025-10-21T07:47:34.416939-07:00","dependencies":[{"issue_id":"MigraineTracker-9","depends_on_id":"MigraineTracker-10","type":"blocks","created_at":"2025-10-21T07:19:11.166026-07:00","created_by":"daemon"},{"issue_id":"MigraineTracker-9","depends_on_id":"MigraineTracker-11","type":"blocks","created_at":"2025-10-21T07:19:24.681978-07:00","created_by":"daemon"},{"issue_id":"MigraineTracker-9","depends_on_id":"MigraineTracker-2","type":"parent-child","created_at":"2025-10-21T07:20:22.195905-07:00","created_by":"daemon"}]}
{"id":"MigraineTracker-939e","content_hash":"5a6f14fc22086b763e3d5f3e89cf25c2346ca4d219cdc6163e1671d3595bae12","title":"Add 'End Episode' button UI to EpisodeDetailScreen","description":"Add button to EpisodeDetailScreen that appears only when viewing an ongoing episode (end_time is null).\n\n**Location:** app/src/screens/EpisodeDetailScreen.tsx\n\n**Requirements:**\n- Button should appear in the header or action area\n- Only visible when episode.end_time is null\n- Follows iOS design patterns\n- Supports light and dark theme\n- Button text: 'End Episode' or appropriate icon\n\n**Reference:**\n- Look at existing buttons in the screen for styling consistency\n- Check theme usage in similar screens","status":"open","priority":1,"issue_type":"task","created_at":"2025-11-02T11:57:22.138353-08:00","updated_at":"2025-11-02T11:57:22.138353-08:00"}
{"id":"MigraineTracker-97f2","content_hash":"78f606c11c0148e1cca606c88e4f534f884958735bd5da69cc6f1b38cbe23207","title":"Add endEpisode action to episodeStore","description":"Create store action to handle ending an ongoing episode.\n\n**Location:** app/src/store/episodeStore.ts\n\n**Requirements:**\n- Add endEpisode(episodeId: string, endTime: Date) action\n- Call episodeRepository.updateEpisode with end_time\n- Update local state to reflect ended episode\n- Handle errors gracefully\n- Ensure UI updates immediately\n\n**Implementation notes:**\n- Follow existing patterns in episodeStore (e.g., updateEpisode action)\n- Verify episodeRepository.updateEpisode correctly handles end_time field\n- May need to check app/src/database/episodeRepository.ts to confirm","status":"open","priority":1,"issue_type":"task","created_at":"2025-11-02T11:58:30.906875-08:00","updated_at":"2025-11-02T11:58:30.906875-08:00"}
{"id":"MigraineTracker-9ca7","content_hash":"91fafc57efc5d5200d8b0fa8b8d96b4f5652a154abf553441e5eed94b0754720","title":"Run precommit checks and verify all tests pass","description":"Execute all precommit checks to ensure code quality and test coverage before pushing.\n\n**Command:** npm run precommit\n\n**This runs:**\n1. ESLint with --max-warnings=0 (no warnings allowed)\n2. TypeScript type checking (npx tsc --noEmit)\n3. Full Jest test suite with coverage (npm run test:ci)\n\n**Success criteria:**\n- npm run precommit exits with code 0 (no errors)\n- All ESLint checks pass with 0 warnings\n- No TypeScript errors\n- All Jest tests pass (100% pass rate)\n- Tests pass in the container environment\n\n**IMPORTANT:** Do not proceed to push or PR creation if this task fails. Fix all issues first.\n\n**If tests fail:**\n- Review error messages carefully\n- Fix code issues\n- Re-run npm run precommit until it passes","status":"open","priority":1,"issue_type":"task","created_at":"2025-11-02T12:01:23.286815-08:00","updated_at":"2025-11-02T12:01:23.286815-08:00","dependencies":[{"issue_id":"MigraineTracker-9ca7","depends_on_id":"MigraineTracker-939e","type":"blocks","created_at":"2025-11-02T12:03:44.004871-08:00","created_by":"vfilby"},{"issue_id":"MigraineTracker-9ca7","depends_on_id":"MigraineTracker-cfd2","type":"blocks","created_at":"2025-11-02T12:03:44.017457-08:00","created_by":"vfilby"},{"issue_id":"MigraineTracker-9ca7","depends_on_id":"MigraineTracker-97f2","type":"blocks","created_at":"2025-11-02T12:03:44.032969-08:00","created_by":"vfilby"},{"issue_id":"MigraineTracker-9ca7","depends_on_id":"MigraineTracker-5236","type":"blocks","created_at":"2025-11-02T12:03:44.044706-08:00","created_by":"vfilby"}]}
{"id":"MigraineTracker-cfd2","content_hash":"c4864bdea456101d8b5b476f6eaade178ff2744b23e6efa2ed90a4bdc92c566d","title":"Implement date/time picker for episode end time","description":"Add date/time picker modal that opens when 'End Episode' button is pressed.\n\n**Location:** app/src/screens/EpisodeDetailScreen.tsx\n\n**Requirements:**\n- Use @react-native-community/datetimepicker (already in project)\n- Default to current date/time\n- Allow user to adjust before confirming\n- Modal should match iOS design patterns\n- Support light and dark theme\n- Handle timezone correctly\n\n**Reference:**\n- Check NewEpisodeScreen for date/time picker usage patterns\n- Ensure consistent UX with existing date pickers in the app","status":"open","priority":1,"issue_type":"task","created_at":"2025-11-02T11:58:19.206034-08:00","updated_at":"2025-11-02T11:58:19.206034-08:00"}
